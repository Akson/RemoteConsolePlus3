<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
	<script type="text/javascript">
		var messages = [];
		var needUpdate = false;
		function RenderMessages()
		{
			//console.log("RenderMessages");
			if(needUpdate)
			{
				//console.log("rendering...");
	            document.getElementById("messages").innerHTML = messages.join("<br>");
	            window.scrollTo(0,document.body.scrollHeight);
	            needUpdate = false;
			}
		}
		function ProcessIncomingMessage(evt)
		{
        	console.log("onmessage", evt.data);
            messages.push(evt.data);
            if(messages.length > 100)
            	messages.shift();
            
            needUpdate = true;
		}
        function OnLoad() 
        {
            if ("WebSocket" in window) 
            {
                document.getElementById("messages").innerHTML = "WebSocket is supported by your Browser!";

                var ws = new WebSocket("ws://137.203.140.8:55558/WebSockets/?StreamName=HtmlConsole");
                ws.onmessage = ProcessIncomingMessage
                ws.onclose = function() { 
                    document.getElementById("messages").innerHTML = "Connection is closed...";
                };

                window.setInterval("javascript:RenderMessages()",50);
			} 
            else 
            {
                document.getElementById("messages").innerHTML = "WebSocket NOT supported by your Browser!";
            }
        }
        </script>
    </head>
    <body onload="javascript:OnLoad()">
        <div id="messages"></div>
    </body>
</html>